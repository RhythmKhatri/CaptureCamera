<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camera Capture</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        #modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            align-items: center;
            justify-content: center;
        }
        #cameraCanvas {
            max-width: 100%;
            max-height: 100%;
        }
        #captureBtn, #retakeBtn, #switchBtn, #confirmBtn {
            margin: 10px;
            padding: 10px;
            font-size: 16px;
        }
    </style>
</head>
<body>

<button id="openCameraBtn">Open Camera</button>

<div id="modal">
    <video id="cameraStream" autoplay playsinline></video>
    <canvas id="cameraCanvas"></canvas>
    <button id="captureBtn">Capture</button>
    <button id="retakeBtn">Retake</button>
    <button id="switchBtn">Switch Camera</button>
    <button id="confirmBtn">Confirm</button>
</div>

<script>
    const openCameraBtn = document.getElementById('openCameraBtn');
    const modal = document.getElementById('modal');
    const cameraStream = document.getElementById('cameraStream');
    const cameraCanvas = document.getElementById('cameraCanvas');
    const captureBtn = document.getElementById('captureBtn');
    const retakeBtn = document.getElementById('retakeBtn');
    const switchBtn = document.getElementById('switchBtn');
    const confirmBtn = document.getElementById('confirmBtn');

    let frontCamera = true;
    let stream;

    openCameraBtn.addEventListener('click', () => {
        openCamera();
    });

    captureBtn.addEventListener('click', () => {
        capturePhoto();
    });

    retakeBtn.addEventListener('click', () => {
        closeCamera();
    });

    switchBtn.addEventListener('click', () => {
        switchCamera();
    });

    confirmBtn.addEventListener('click', () => {
        // Implement sending the captured photo to your API
        // You can use the captured image data from cameraCanvas.toDataURL()
        closeCamera();
    });

    function openCamera() {
        navigator.mediaDevices.getUserMedia({ video: { facingMode: frontCamera ? 'user' : 'environment' } })
            .then((s) => {
                stream = s;
                cameraStream.srcObject = stream;
                modal.style.display = 'flex';
            })
            .catch((err) => {
                console.error('Error accessing the camera: ', err);
            });
    }

    function closeCamera() {
        if (stream) {
            const tracks = stream.getTracks();
            tracks.forEach((track) => track.stop());
            cameraStream.srcObject = null;
            modal.style.display = 'none';
        }
    }

    function capturePhoto() {
        const context = cameraCanvas.getContext('2d');
        context.drawImage(cameraStream, 0, 0, cameraCanvas.width, cameraCanvas.height);
    }

    function switchCamera() {
        frontCamera = !frontCamera;
        closeCamera();
        openCamera();
    }
</script>

</body>
</html> -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camera Capture</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        #modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        #cameraStream {
            max-width: 100%;
            max-height: 100%;
        }
        #cameraCanvas {
            max-width: 100%;
            max-height: 80vh;
        }
        #captureBtn, #retakeBtn, #switchBtn, #confirmBtn {
            margin: 10px;
            padding: 10px;
            font-size: 16px;
        }
    </style>
</head>
<body>

<button id="openCameraBtn">Open Camera</button>

<div id="modal">
    <video id="cameraStream" autoplay playsinline></video>
    <canvas id="cameraCanvas"></canvas>
    <button id="captureBtn">Capture</button>
    <button id="retakeBtn">Retake</button>
    <button id="switchBtn">Switch Camera</button>
    <button id="confirmBtn">Confirm</button>
</div>

<script>
    const openCameraBtn = document.getElementById('openCameraBtn');
    const modal = document.getElementById('modal');
    const cameraStream = document.getElementById('cameraStream');
    const cameraCanvas = document.getElementById('cameraCanvas');
    const captureBtn = document.getElementById('captureBtn');
    const retakeBtn = document.getElementById('retakeBtn');
    const switchBtn = document.getElementById('switchBtn');
    const confirmBtn = document.getElementById('confirmBtn');

    let frontCamera = true;
    let stream;

    openCameraBtn.addEventListener('click', () => {
        openCamera();
    });

    captureBtn.addEventListener('click', () => {
        capturePhoto();
    });

    retakeBtn.addEventListener('click', () => {
        closeCamera();
    });

    switchBtn.addEventListener('click', () => {
        switchCamera();
    });

    confirmBtn.addEventListener('click', () => {
        // Implement sending the captured photo to your API
        // You can use the captured image data from cameraCanvas.toDataURL()
        closeCamera();
    });

    function openCamera() {
        navigator.mediaDevices.getUserMedia({ video: { facingMode: frontCamera ? 'user' : 'environment' } })
            .then((s) => {
                stream = s;
                cameraStream.srcObject = stream;
                modal.style.display = 'flex';
            })
            .catch((err) => {
                console.log(err);
                console.log(err.name);
                console.log(err.stack)
                console.log(err.message)

            });
    }

    function closeCamera() {
        if (stream) {
            const tracks = stream.getTracks();
            tracks.forEach((track) => track.stop());
            cameraStream.srcObject = null;
            modal.style.display = 'none';
        }
    }

    function capturePhoto() {
        const context = cameraCanvas.getContext('2d');
        context.drawImage(cameraStream, 0, 0, cameraCanvas.width, cameraCanvas.height);
    }

    function switchCamera() {
        frontCamera = !frontCamera;
        closeCamera();
        openCamera();
    }
</script>

</body>
</html>
